<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>cardtype.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="CardType.html">CardType</a><ul class='methods'><li data-type='method'><a href="CardType.html#getType">getType</a></li><li data-type='method'><a href="CardType.html#isValid">isValid</a></li><li data-type='method'><a href="CardType.html#isValidLuhn">isValidLuhn</a></li><li data-type='method'><a href="CardType.html#normalize">normalize</a></li><li data-type='method'><a href="CardType.html#validate">validate</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">cardtype.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/* eslint-env browser, node, amd */
(function (root, factory) {
    if (typeof define === 'function' &amp;&amp; define.amd) {
        define([], factory);
    } else if (typeof module === 'object' &amp;&amp; module.exports) {
        module.exports = factory();
    } else {
        root.CardType = factory();
    }
})(this, function () {
    function _indexOf(needle) {
        var indexOf;
        if (typeof Array.prototype.indexOf === 'function') {
            indexOf = Array.prototype.indexOf;
        } else {
            indexOf = function (needle) {
                var i = -1;
                var index = -1;
                for (i = 0; i &lt; this.length; i++) {
                    if (this[i] === needle) {
                        index = i;
                        break;
                    }
                }
                return index;
            };
        }
        return indexOf.call(this, needle);
    }

    /**
     * @class CardType
     * @param {Array} accepted - Array of accepted card types
     * @return {Object}
     * @author David Rapson
     * @see Based on {@link https://github.com/PawelDecowski/jQuery-CreditCardValidator/}
     * @license
     * This work is licensed under the Creative Commons Attribution-ShareAlike 3.0
     * Unported License. To view a copy of this license, visit:
     * http://creativecommons.org/licenses/by-sa/3.0/
     */
    function CardType(accepted) {
        this.acceptedTypes = accepted || [
            'amex',
            'diners_club_carte_blanche',
            'diners_club_international',
            'discover',
            'jcb',
            'laser',
            'maestro',
            'mastercard',
            'visa_electron',
            'visa'
        ];
        this.cardTypes = [
            {
                name: 'amex',
                pattern: /^3[47]/,
                validLength: [15]
            },
            {
                name: 'diners_club_carte_blanche',
                pattern: /^30[0-5]/,
                validLength: [14]
            },
            {
                name: 'diners_club_international',
                pattern: /^36/,
                validLength: [14]
            },
            {
                name: 'discover',
                pattern: /^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)/,
                validLength: [16]
            },
            {
                name: 'jcb',
                pattern: /^35(2[89]|[3-8][0-9])/,
                validLength: [16]
            },
            {
                name: 'laser',
                pattern: /^(6304|670[69]|6771)/,
                validLength: [16, 17, 18, 19]
            },
            {
                name: 'maestro',
                pattern: /^(5018|5020|5038|6304|6759|676[1-3])/,
                validLength: [12, 13, 14, 15, 16, 17, 18, 19]
            },
            {
                name: 'mastercard',
                pattern: /^5[1-5]/,
                validLength: [16]
            },
            {
                name: 'visa_electron',
                pattern: /^(4026|417500|4508|4844|491(3|7))/,
                validLength: [16]
            },
            {
                name: 'visa',
                pattern: /^4/,
                validLength: [16]
            }
        ];
        return this;
    }

    /**
     * Get type object
     *
     * @memberof CardType
     * @param number - Card number
     * @return {Object} - Card type details
     */
    CardType.prototype.getType = function (number) {
        var types = this.cardTypes;
        for (var i = 0; i &lt; types.length; i++) {
            if ((number.match(types[i].pattern)) &amp;&amp; (_indexOf.call(this.acceptedTypes, types[i].name) > -1)) {
                return types[i];
            }
        }
        return false;
    };

    /**
     * Passes Luhn algorithm
     *
     * @memberof CardType
     * @see {@link http://en.wikipedia.org/wiki/Luhn_algorithm}
     * @param {String} number - Card number
     * @return {Boolean}
     */
    CardType.prototype.isValidLuhn = function (number) {
        var sum = 0;
        var digits = number.split('').reverse();
        var digit;

        for (var i = 0; i &lt; digits.length; i++) {
            digit = Number(digits[i]);
            if (i % 2) {
                digit *= 2;
                sum += (digit &lt; 10) ? digit : digit - 9;
            } else {
                sum += digit;
            }
        }
        return sum % 10 === 0;
    };

    /**
     * Card has valid length
     *
     * @param {String} number - Card number
     * @param {Object} cardType - Type object for card
     * @return {Boolean}
     */
    CardType.prototype.isValidLength = function (number, cardType) {
        return (_indexOf.call(cardType.validLength, number.length) > -1);
    };

    /**
     * Passes Luhn &amp; length check
     *
     * @memberof CardType
     * @param {String} number - Card number
     * @return {Boolean}
     */
    CardType.prototype.isValid = function (number) {
        return this.validate(number).valid;
    };

    /**
     * Validate card details
     *
     * @memberof CardType
     * @param {String} number - Card number
     * @return {Object} Validation object
     *
     * @example
     * // returns { valid: true, validLength: true, isValidLuhn: true, cardType: 'visa' }
     * var card = new CardType();
     * card.validate('4000000000000002');
     */
    CardType.prototype.validate = function (number) {
        var normalized = this.normalize(number);
        var cardType = this.getType(normalized);
        var validLuhn = (cardType) ? this.isValidLuhn(normalized) : false;
        var validLength = (cardType) ? this.isValidLength(normalized, cardType) : false;

        return {
            valid: (validLuhn &amp;&amp; validLength),
            validLuhn: validLuhn,
            validLength: validLength,
            cardType: cardType.name
        };
    };

    /**
     * Strip '-' and ' ' characters
     *
     * @memberof CardType
     * @param {String} number - Card number
     * @return {String} Normalised card number
     */
    CardType.prototype.normalize = function (number) {
        return number.replace(/[ -]/g, '');
    };

    return CardType;
});
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.3</a> on Thu Nov 05 2015 16:03:17 GMT+0000 (GMT) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
